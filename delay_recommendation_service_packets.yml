experiment:
  # hypothesis: packet loss will show in number of transmitted packets
  # hypothesis: packet loss will show in trace duration
  responses:
    - recommendation_packets:
        type: metric
        metric_name: system_network_packets
        labels: {
          device: "eth0",
          # injection affects egress traffic
          direction: "transmit",
        }
        left_window: 1m
        right_window: 1m
        step: 1
    - recommendation_traces:
        type: trace
        service_name: recommendationservice
        left_window: 1m
        right_window: 1m
        limit: 1000
  treatments:
    - packet_loss_treatment:
        action: delay
        params: {
          service_name: recommendation-service,
          duration: 30s,
          delay_time: 100ms,
          interface: eth0,
        }
  sue:
    compose: /Users/witch/opentelemetry-demo/docker-compose.yml
  loadgen:
    run_time: 150s
    tasks:
    - { endpoint: /, verb: get, weight: 1, params: { } }
    - { endpoint: /api/products/0PUK6V6EV0, verb: get, weight: 1, params: { } }
    - { endpoint: /api/recommendations, verb: get, weight: 1, params: { "productIds": ["1YMWWN1N4O"]}}
    - { endpoint: /api/cart, verb: get, weight: 1, params: {} }
    - { endpoint: /api/data, verb: get, weight: 1, params: { "contextKeys": [ "telescopes" ] } }
